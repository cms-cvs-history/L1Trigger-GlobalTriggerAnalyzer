//
// cfg file to run 
// L1 muon chain + L1 calorimeter chain + L1 Global Trigger emulators + L1 GT Analyzer 
// on GEN + SIM + DIGI events 
//

process RunGtAnalyzerDigi = {

    // input file: GEN + SIM + DIGI 
    source = PoolSource {
	    untracked vstring fileNames = {
	    "/store/RelVal/2007/6/22/RelVal-RelVal150QCD_pt80_120-1182500741/0000/7EEAEE46-BD20-DC11-848C-000423D9880C.root"
	    }
    }

    untracked PSet maxEvents = { untracked int32 input = 10 }

    // load and configure modules
    
    // Geometry - to be revised
    include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"
    include "Geometry/CMSCommonData/data/cmsIdealGeometryXML.cfi"

    // calorimeter emulator chain
    include "L1Trigger/Configuration/data/L1CaloEmulator.cff"

    // muon emulator chain 
    //   depends on calorimeter chain
    include "L1Trigger/Configuration/data/L1MuonEmulator.cff"

    // Global Trigger emulator
    //   depends on calorimeter chain and muon chain
    include "L1Trigger/GlobalTrigger/data/l1GtEmulDigis.cfi"

    // this module
	include "L1Trigger/GlobalTriggerAnalyzer/data/l1GtAnalyz.cfi"
    
    // module list
    //path p = { L1CaloEmulator, L1MuonEmulator, l1GtEmulDigis, l1GtAnalyz }
    path p = { l1calo & l1muon & l1GtEmulDigis, l1GtAnalyz}

    // uncomment / comment messages with DEBUG mode to run in DEBUG mode
    service = MessageLogger {

        untracked vstring destinations =  {"L1GtAnalyzer_RelVal150QCD_pt80_120"}
        untracked PSet L1GtAnalyzer_RelVal150QCD_pt80_120 = { 
            untracked string threshold = "DEBUG"                  // DEBUG 
            untracked PSet DEBUG = { untracked int32 limit = -1}  // DEBUG, all messages  
            //untracked PSet DEBUG = { untracked int32 limit = 10}  // DEBUG, max 10 messages  
          untracked PSet INFO = { untracked int32 limit = -1}    
      }
      untracked vstring debugModules = { "l1GtAnalyz"}          // DEBUG mode 
      
    }

    // keep only GMT, GCT and GT output records
        
    module outputL1GtAnalyzer = PoolOutputModule { 
        untracked vstring outputCommands = {
            "drop *",
            "keep *_L1GmtEmulDigis_*_*",
            "keep *_L1GctEmulDigis_*_*",
            "keep *_L1GtEmulDigis_*_*"
        }

        untracked string fileName = "L1GtAnalyzer_RelVal150QCD_pt80_120.root" 
    }
    
    endpath outpath = { outputL1GtAnalyzer }
    
        
}